<!-- File: readme.html
  Copyright (c) 2016-2019 Splunk Inc.

  SPLUNK CONFIDENTIAL - Use or disclosure of this material in whole or in part
  without a valid written license from Splunk Inc. is PROHIBITED.
-->
<h2 id="appid">Preprocess Script</h2>
    <p>
    The user can add a script file in the configuration parameter <b>Script with functions to preprocess containers and artifacts</b>. The script must contain a function with the name <b>preprocess_container</b> (to pre-process the containers and the artifacts) or else, it will throw an error.
    </p>

<h2 id="appid">On Poll</h2>
    <ul>
        <li>Default parameters of the On Poll action are ignored in the app. i.e. start_time, end_time, container_count, artifact_count</li>
        <li>The app will fetch all the events based on the value specified in the configuration parameters "Maximum events to get while POLL NOW" and the "Maximum events to get while scheduled and interval polling" irrespective of their event type and then, only those events which are of the type <b>DetectionSummaryEvent</b> will be considered for ingestion. If there are no events of the type <b>DetectionSummaryEvent</b> in the fetched events list, try again by increasing the count specified in the earlier mentioned configuration parameters in this step.</li>
        <li>During POLL NOW, the app starts from the 1st event that it can query up to the value configured in the configuration parameter "Maximum events to get while POLL NOW" and creates artifacts for all the fetched events. The last queried event's offset ID will not be remembered in POLL NOW.</li>
        <li>During scheduled polls, the app starts from the 1st event that it can query up to the value configured in the configuration parameter "Maximum events to get while scheduled and interval polling" and creates artifacts for all the fetched events, but then remembers the last event's offset ID that it queried for. In the next scheduled poll, it will start from the last event's offset ID and will fetch the maximum events as configured in the "Maximum events to get while scheduled and interval polling" parameter.</li>
        <li>
        The default behavior of the app is that each event will be placed in its own container.
        By checking the configuration parameter "Merge containers for Hostname and Eventname" as well as specifying an interval in the configuration parameter "Merge same containers within specified seconds", all events which are of the same type and on the same host will be put into one container, as long as the time between those two events is less than the interval.
        </li>
    </ul>

<p>The <b>DetectionSummaryEvent</b> is parsed to extract the following values into an Artifact.<br></p>

<table style="width:100%">
    <tr>
        <td><b>Artifact Field</b></td>
        <td><b>Event Field</b></td>
    </tr>
    <tr>
        <td>cef.sourceUserName</td>
        <td>UserName</td>
    </tr>
    <tr>
        <td>cef.fileName</td>
        <td>FileName</td>
    </tr>
    <tr>
        <td>cef.filePath</td>
        <td>FilePath</td>
    </tr>
    <tr>
        <td>cef.sourceHostName</td>
        <td>ComputerName</td>
    </tr>
    <tr>
        <td>cef.sourceNtDomain</td>
        <td>MachineDomain</td>
    </tr>
    <tr>
        <td>cef.hash</td>
        <td>MD5String</td>
    </tr>
    <tr>
        <td>cef.hash</td>
        <td>SHA1String</td>
    </tr>
    <tr>
        <td>cef.hash</td>
        <td>SHA256STring</td>
    </tr>
    <tr>
        <td>cef.cs1</td>
        <td>cmdLine</td>
    </tr>
</table>

<p>The App also parses the following <b>sub events</b> into their own Artifacts.<br></p>
    <ul>
        <li>Documents Accessed</li>
        <li>Executables Written</li>
        <li>Network Access</li>
        <li>Scan Result</li>
        <li>Quarantine Files</li>
        <li>Dns Requests</li>
    </ul>

<p>Each of the sub events has a cef key called <b>parentSdi</b> that stands for Parent Source Data Identifier. This is the value of the SDI of the main event that the sub events were generated from.</p>

<h2 id="appid">App ID</h2>
    <ul>
        <li>Optionally, you can specify an <b>App ID</b> to be used with the Streaming API. If one isn't set, it will default to the asset id.</li>
        <li>It is recommended to have a unique <b>App ID</b> for each connection to the Streaming API. That is to say, if you are planning on having multiple assets using the Streaming API at once, you should give them unique App IDs.</li>
    </ul>
